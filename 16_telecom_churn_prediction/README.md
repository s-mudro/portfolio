# Краткое содержание

В ходе проекта я объединил данные и провел анализ, выявив зависимости и дисбаланс классов. Обработал пропущенные значения и исключил линейно зависимые признаки. Обучил несколько моделей и выбрал лучшую — **CatBoostClassifier**, с которой достиг ROC-AUC 0.909 и accuracy **0.894** на тестовых данных. Основные влияющие признаки: *длительность обслуживания, общая и ежемесячная плата, тип и метод оплаты*. Подробнее о каждом из этапов — ниже.

## 1. Ключевые шаги
- **Загрузил и ознакомился с данными**: объединил данные из разных источников в одну таблицу для удобства анализа.
- **Провел первичный анализ данных**: визуализация и статистический анализ данных помогли выявить дисбаланс классов (см. ниже), пропущенные значения и зависимости между переменными.
- Сделал промежуточные выводы на основе первичного анализа данных, определил дальнейшие шаги работы.
- **Этапы обучения и контроль качества моделей**:
  - **Подготовил признаки**: удалил наименее информативные признаки и добавил недостающие.
  - **Обучил и сравнил модели**: обучил **DecisionTreeClassifier**, **RandomForestClassifier** и **CatBoostClassifier**. Для подбора гиперпараметров использовал метод **GridSearchCV**.
  - **Проверил качество моделей**: оценил результаты на тестовых данных с метриками **ROC-AUC** и **accuracy**.
- **Финальные выводы**: ===вы находитесь здесь===

## 2. Подробнее о features
- Обнаружил, что признаки `monthly_charges`, `internet_service`, `streaming_tv` и `streaming_movies` имеют сильную линейную зависимость друг от друга. Это может вызвать проблемы при обучении модели и интерпретации результатов, поэтому исключил эти признаки из рассмотрения, оставив только `monthly_charges` (подробнее о зависимости см. рис. ниже).
- Создал целевой признак на основе информации о дате окончания контракта. Если данные об уходе клиента отсутствуют, счел его действующим клиентом и присвоил значение 0, в противном случае — 1.
- Добавил признак `tenure`, который отражает количество дней, проведенных клиентом в компании. Признак рассчитан как разница между датами окончания и начала контракта, учитывая актуальную дату (2020-02-01) в случае отсутствия данных об окончании.
- Сохранил дисбаланс классов при разбиении выборки на части методом стратификации.

## 3. Обработка данных
- Пропущенные значения в признаке `total_charges`, которые, скорее всего, вызваны тем, что новые клиенты еще не оплатили свои счета, заполнил значением 0.
- После объединения данных в одну таблицу обнаружил пропуски в связанных с интернет-услугами колонках, таких как `internet_service`, `online_security`, `online_backup`, `device_protection`, `tech_support`, `streaming_tv`, `streaming_movies`, и в признаке `multiple_lines`. Вероятно, это связано с тем, что некоторые клиенты не пользуются этими услугами, поэтому данных о них отсутствуют. Пропуски заполнил соответствующими значениями.

## 4. Лучшая модель и ее результаты
- Для **DecisionTreeClassifier**, **RandomForestClassifier** и **CatBoostClassifier** подобрал наилучшие гиперпараметры методом **GridSearchCV**. Для сравнения использовал метрику **ROC-AUC**.
- Лучшая модель — **CatBoostClassifier** с AUC-ROC = 0.896 и гиперпараметрами `depth=5`, `learning_rate=0.5`, `iterations=200`.
- На тестовых данных модель показала ROC-AUC 0.906 при необходимом **ROC-AUC >= 0.85** и accuracy **0.879**, который более чувствителен к дисбалансу классов, чем ROC-AUC. Модель также успешно прошла проверку на адекватность (см. матрицу ошибок финальной модели ниже).
- Проверил модель на адекватность.

## 5. Выводы по анализу важности признаков
- Наибольшее влияние на модель оказали признаки `tenure` (длительность обслуживания клиента), а также суммарные признаки: `total_charges`, `monthly_charges`, `type`, `payment_method`. Остальные признаки имеют меньшую значимость для моделирования (подробнее см. рис. ниже).

Резюмируя, на основе проведенного анализа и обучения моделей можно рекомендовать использовать модель **CatBoostClassifier** для решения задачи удержания клиентов. Модель показала лучшие результаты по ключевым метрикам, что доказывает её способность предсказывать, останется ли клиент или уйдет, основываясь на имеющихся данных.

Однако перед внедрением модели в работу рекомендуется провести анализ прогнозных значений и дополнительное тестирование на независимых данных, чтобы убедиться в ее надежности и стабильности. По результатам дополнительного тестирования можно провести оптимизацию модели, настроив её гиперпараметры. В ходе внедрения в работу рекомендуется мониторить модель и обновлять данные.
