**Краткое содержание:**

В ходе проекта мы объединили данные и провели анализ, выявив зависимости и дисбаланс классов. Обработали пропущенные значения и исключили линейно зависимые признаки. Обучили несколько моделей и выбрали лучшую - CatBoostClassifier, с которой достигли ROC-AUC 0.909 и accuracy **0.894** на тестовых данных. Основные влияющие признаки оказались *длительность обслуживания, общая и ежемесячная плата, тип и метод оплаты*. Ниже можно узнать подробнее о каждом из этапов.

1. **Ключевые шаги**
   - Загрузка и ознакомление с данными: объединение данных из разных источников в одну таблицу для удобства анализа.
   - Первичный анализ данных: визуализация и статистический анализ данных помогли выявить дисбаланс классов(см.ниже), пропущенные значения и зависимости между переменными.
   - Сделали промежуточные выводы на основе результатов первичного анализа данных и определили дальнейшие шаги работы.
   - Этапы обучения и контроль качества моделей:
     - Подготовка признаков: удаление наименее информативных признаков и добавиление недостающих.
     - Обучение и сравнение моделей: DecisionTreeClassifier, RandomForestClassifier и CatBoostClassifier. Для подбора гиперпараметров использовали метод GridSearchCV.
     - Тестирование: Проверили качество моделей на тестовых данных метриками ROC-AUC и accuracy.
   - Финальные выводы: ===вы находитесь здесь===

2. **Подробнее о features**
   - Обнаружили, что признаки `monthly_charges`, `internet_service`, `streaming_tv` и `streaming_movies` имеют сильную линейную зависимость друг от друга. Это может вызвать проблемы при обучении модели и интерпретации результатов, поэтому исключили эти признаки из рассмотрения, оставив только monthly_charges (подробнее о зависимости см. рис. ниже).

   - Создали целевой признак на основе информации о дате окончания контракта. Если данные об уходе клиента отсутствуют, считаем его действующим клиентом и присваиваем значение 0, в противном случае - 1.
   - Добавили признак `tenure`, который отражает количество дней, проведенных клиентом в компании. Признак рассчитан как разница между датами окончания и начала контракта, учитывая актуальную дату (2020-02-01) в случае отсутствия данных об окончании.
   - Сохранили дисбаланс классов при разбиении выборки на части методом стратификации.

3. **Обработка данных**
   - Пропущенные значения в признаке `total_charges`, которые, скорее всего, вызваны тем, что новые клиенты еще не оплатили свои счета, заполнили значением 0.
   - После объединения данных в одну таблицу были обнаружены пропуски в связанных с интернет-услугами колонках, таких как `internet_service`, `online_security`, `online_backup`, `device_protection`, `tech_support`, `streaming_tv`, `streaming_movies`, и в признаке `multiple_lines`. Вероятно, это связано с тем, что некоторые клиенты не пользуются этими услугами, поэтому данных о них отсутствуют. Пропуски были заполнены соответствующими значениями.

4. **Лучшая модель и ее результаты**
   - Для DecisionTreeClassifier, RandomForestClassifier и CatBoostClassifier подобрали наилучшие гиперпараметры методом GridSearchCV. Для сравнения использовали метрику ROC-AUC. Ниже таблица результатов сравнения.
   - Лучшая модель по результатам - **CatBoostClassifier** с AUC-ROC = 0.896 и с гиперпараметрами `depth=5`, `learning_rate=0.5`, `iterations=200`.
   - На тестовых данных модель показала ROC-AUC 0.906 при необходимом ROC-AUC >= 0.85 и accuracy **0.879**, который более чувствительный к дисбалансу классов чем ROC-AUC. Модель также успешно прошла проверку на адекватность (см.матрицу ошибок финальной модели ниже).
   - Проверка модели на адекватность.


6. **Выводы по анализу важности признаков**
   - Наибольшее влияние на модель оказывают признаки `tenure` (длительность обслуживания клиента), а также суммарные признаки: `total_charges`, `monthly_charges`, `type`, `payment_method`. Остальные признаки имеют меньшую значимость для моделирования (подробнее см. рис. ниже).

Резюмируя, на основе проведенного анализа и обучения моделей, можно рекомендовать использовать модель CatBoostClassifier для решения задачи удержания клиентов. Модель показала лучшие результаты по ключевым метрикам, что доказывает её способность предсказывать, останется ли клиент или уйдет, основываясь на имеющихся данных.

Однако перед внедрением модели в работу, рекомендуется провести анализ прогнозных значений и дополнительное тестирование на независимых данных, чтобы убедиться в ее надежности и стабильности. По результатам которого, можно провести дополнительную оптимизацию модели, настроив ее гиперпараметры. В ходе внедрения в работу, рекомендуется мониторинг модели и обновление данных. 
